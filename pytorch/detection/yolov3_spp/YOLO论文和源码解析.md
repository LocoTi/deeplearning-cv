# YOLO论文和源码解析

## YOLOv1

### 网络结构

![image-20210502111835175](图表库/image-20210502111835175.png)



输出：

![image-20210502111916637](图表库/image-20210502111916637.png)

### 损失

![image-20210502112009112](图表库/image-20210502112009112.png)



## YOLOv2

### 网络结构

#### Backbone-Darknet19

![image-20210502112259986](图表库/image-20210502112259986.png)



#### YOLOv2模型

将Darknet19最后一部分卷积进行替换，得到如下模型结构：

![image-20210502112411805](图表库/image-20210502112411805.png)



## YOLOv3

### 网络结构

没有Maxpooling层，下采样通过卷积层设置stride为2来实现，比resnet提升

![image-20210502125235193](图表库/image-20210502125235193.png)



![image-20210502125632468](图表库/image-20210502125632468.png)



### 尺度

在三个特征层上进行预测，每个特征层上有三种尺度的box。

同样经过k-means算法，得到9个聚类中心，分成3组，刚好对应三个特征层，每个特征层三种尺度。

![img](图表库/20190713210846716.png)



对每个尺度$N*N$大小的特征图，对COCO数据集而言，则数据维度为$N*N*[3*(4+1+80)]$，每个点有3个boxes，每个box预测4个边界框参数，1个物体confidence，80个类别分数。

![image-20210502130859961](图表库/image-20210502130859961.png)



### 边界框预测

![image-20210502131313968](图表库/image-20210502131313968.png)



### 损失函数

损失函数由三个部分构成

![image-20210502132038762](图表库/image-20210502132038762.png)



![image-20210502132127106](图表库/image-20210502132127106.png)



![image-20210502132403287](图表库/image-20210502132403287.png)





![image-20210502132955164](图表库/image-20210502132955164.png)



## Yolov3 SPP

### 增加部分

![image-20210502143635898](图表库/image-20210502143635898.png)

### 网络结构

![yolov3spp](图表库/yolov3spp.png)





### SPP模块

![image-20210502143724818](图表库/image-20210502143724818.png)

SPP模块会将通道数增加4倍

### 损失

![image-20210502144128900](图表库/image-20210502144128900.png)



#### IOU loss

两种形式：$loss = -ln(IOU)$或$loss = 1 - IOU$。

缺点是，两者不相交时，IOU=0，损失为无穷大或1。

![image-20210502144235664](图表库/image-20210502144235664.png)



#### GIOU loss

$A^c$是两矩形框的最小边界框，$u$是两矩形的并集部分。

完美重合时$GIoU = IoU - 0 = 1$，不相交且无穷远时$GIou = 0 - 1 = -1$。

损失为：$L = 1 - GIoU$



![image-20210502144539881](图表库/image-20210502144539881.png)



#### DIOU loss

![image-20210502145623218](图表库/image-20210502145623218.png)

![image-20210502150054064](图表库/image-20210502150054064.png)



#### CIOU loss

![image-20210502150304599](图表库/image-20210502150304599.png)



#### Focal loss

![image-20210502150724571](图表库/image-20210502150724571.png)



![image-20210502151257538](图表库/image-20210502151257538.png)





![image-20210502151335339](图表库/image-20210502151335339.png)





![image-20210502151443233](图表库/image-20210502151443233.png)



![image-20210502151739442](图表库/image-20210502151739442.png)



$\gamma=2, \alpha=0.25$的情况，可以看到易分样本的权重降低很多：

![image-20210502151934235](图表库/image-20210502151934235.png)





## 参考

https://github.com/WZMIAOMIAO/deep-learning-for-image-processing